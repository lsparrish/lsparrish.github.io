<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Mod 5 Drill</title>
<style>
*{box-sizing:border-box;margin:5px;padding:5px}:root{--pb:#0f0f0f;--cb:#1a1a1a;--eb:#242424;--ag:#00d4aa;--ab:#377;--tp:#fff;--ts:#a3a3a3;--sb:#064e3b;--st:#6ee7b7;--eb:#7f1d1d;--et:#fca5a5;--bs:#404040;--ss:0 4px 6px -1px rgba(0,0,0,.3);--sm:0 10px 15px -3px rgba(0,0,0,.4);--br:12px;--brs:8px}
body{font-family:Roboto,sans-serif;background:var(--pb);color:var(--tp);min-height:100vh;line-height:1.6;overflow-x:hidden}
.problem-section,.problem,.result{text-align:center}
.problem{font-size:clamp(2rem,6vw,3rem);font-weight:800;margin:1rem 0;padding:1.5rem;background:var(--sb);border-radius:var(--br);border:2px solid var(--ag);color:var(--ag);text-shadow:0 0 20px rgba(0,212,170,.3);transition:all .3s ease}
.problem.pulse{animation:pulse .6s ease-in-out}
.result{font-size:1.1rem;font-weight:600;margin:1rem 0;padding:.75rem;border-radius:var(--brs);min-height:3rem;display:flex;align-items:center;justify-content:center;transition:all .3s ease}
.result.correct{background:var(--sb);color:var(--st);border:1px solid var(--st)}
.result.wrong{background:var(--eb);color:var(--et);border:1px solid var(--et);animation:shake .5s ease-in-out}
.hidden{visibility:hidden;height:0;margin:0;overflow:hidden}
.tables-container{display:grid;gap:1rem;grid-template-columns:repeat(2,1fr)}
.table-wrapper{background:var(--sb);border-radius:var(--brs);overflow:hidden;border:1px solid var(--bs)}
.hint-table{width:100%;border-collapse:collapse}
.hint-table caption{padding:.75rem;font-weight:600;background:var(--ab);color:#dadafa;font-size:.9rem;text-shadow:0 1px 2px rgba(0,0,0,.3)}
.hint-table td{padding:.5rem;text-align:center;border:1px solid var(--bs);font-family:'SF Mono',Monaco,monospace;font-size:.8rem;transition:all .2s ease}
.hint-table td:hover{background:var(--bs)}
.highlight{background:linear-gradient(45deg,#fbbf24,#f59e0b)!important;color:#000!important;font-weight:700;box-shadow:0 0 10px rgba(251,191,36,.5)}
@media(max-width:768px){.tables-container{grid-template-columns:1fr;gap:.75rem}.problem{font-size:clamp(1.5rem,8vw,2.5rem);padding:1rem}.hint-table td{padding:.4rem;font-size:.75rem}.hint-table caption{padding:.75rem;font-weight:600;background:var(--ab);color:#fff;font-size:.9rem;text-shadow:0 1px 2px rgba(0,0,0,.3)}.mobile-keys{display:flex}
.mobile-key {flex: 1;font-size: clamp(2rem, 10vw, 3rem);padding: 0.5rem;text-align: center;background: #fff;color: #000;cursor: pointer;}
.mobile-key:active {background: var(--bs);}
}
</style>
</head>
<body>
<div class="container">
<div class="problem" id="problem"></div>
<div class="result" id="result"></div>
<div class="mobile-keys" id="mobile-keys"></div>
<div class="score" id="score">Score: 0</div>
<div class="streak" id="streak">Streak: 0</div>
<div class="hint-container" id="hints"></div>
<div class="instructions" id="instructions">
Modulus 5 drill for improving your recall of multiplication facts.<br>
There are only 5 answers. However, 5 through 9 are equivalent to 0 through 4, so you can practice base 10.
Press T to toggle distracting details.<br>
Press H to switch between hint modes.<br>
Press I to hide instructions.<br>
Press . to toggle sound.<br>
Use ASDFG, ZXCVB, or number keys.</div>
</div>
<script>
let a,b,ans,score=0,minVal=5,width=3,mult=1,streak=0,prevA,prevB,hintMode=0,audioCtx,soundOn=1;

const $=id=>document.getElementById(id);
const sound=(freqs,dur=0.3,type='sine')=>{
    if(!audioCtx)audioCtx=new(window.AudioContext||window.webkitAudioContext)();
    const t=audioCtx.currentTime;
    if (!soundOn) return;
    freqs.forEach((f,i)=>{
        const o=audioCtx.createOscillator(),g=audioCtx.createGain();
        o.connect(g);g.connect(audioCtx.destination);
        o.frequency.value=f;o.type=type;
        g.gain.setValueAtTime(0.1,t);g.gain.exponentialRampToValueAtTime(0.01,t+dur);
        o.start(t+i*0.05);o.stop(t+dur);
    });
};

const highlight=()=>{
    if($('hints').classList.contains('hidden')) { return; }
    document.querySelectorAll('.highlight').forEach(el=>el.classList.remove('highlight'));
    $('hints').classList.toggle('hidden', hintMode>=3);
    if(hintMode<2){
        const cell=document.querySelectorAll('.hint-table td')[(a%5)*6+(b%5)];
        cell&&cell.classList.add('highlight');
    }
    if(hintMode<1){
        [ans%5,ans%5+5].forEach(i=>{
            const cell=document.querySelectorAll('.hint-table')[1]?.querySelectorAll('td')[(i-1)%5];
            cell&&cell.classList.add('highlight');
        });
    }
};

const newProblem=()=>{
    do{a=Math.floor(Math.random()*(width+1))+minVal;b=mult}while(a===prevA&&b===prevB);
    prevA=a;prevB=b;ans=(a*b)%5;
    $('problem').textContent=`${a} Ã— ${b}`;
    highlight();
};

const makeTable=(cap,data,cols)=>{
    let html=`<table class="hint-table"><caption>${cap}:</caption>`;
    for(let i=0;i<data.length;i+=cols){
        html+='<tr>';
        for(let j=0;j<cols&&i+j<data.length;j++)html+=`<td>${data[i+j]}</td>`;
        html+='</tr>';
    }
    return html+'</table>';
};

document.onkeydown=e=>{
    if (e.key.toUpperCase() === 'T') {
        const elements = ['instructions','streak','result','score','hints'];
        const allHidden = elements.every(id => document.getElementById(id)?.classList.contains('hidden'));
        elements.forEach(id => document.getElementById(id)?.classList.toggle('hidden', !allHidden));
        highlight();
        return;
    }
    if(e.key.toUpperCase()==='H'){
        hintMode=(hintMode+1)%4;
        highlight();
        return;
    }
    if(e.key.toUpperCase()==='I'){
        $('instructions').classList.toggle('hidden');
        return;
    }
    if(e.key==='.'){
        soundOn=1-soundOn;
        return;
    }
    const userAns='GASDFZXCVB0123456789'.indexOf(e.key.toUpperCase());
    if(userAns!==-1){
        if(userAns%5===ans){
            sound([261.63,329.63,392.00]);
            score++;streak++;
            $('score').textContent=`Score: ${score}`;
            $('streak').textContent=`Streak: ${streak}`;
            $('result').textContent='Correct!';
            $('result').classList.contains('hidden') || ($('result').className = 'result correct');
            if(streak%5===0){
                if(minVal<9&&width<5){minVal++;width++;}
                if(mult<20){mult++;} else {mult=1;width++;minVal=Math.max(1,minVal-1);}
            }
            newProblem();
        }else{
            sound([261.63, 293.66, 329.63]);
            streak=0;score=Math.max(0,score-1);
            $('result').textContent='Try again!';
            $('result').classList.contains('hidden') || ($('result').className = 'result wrong');
            $('streak').textContent=`Streak: ${streak}`;
            $('score').textContent=`Score: ${score}`;
        }
    }
};
const isMobileDevice = () => {
    return window.innerWidth <= 768 && (
        'ontouchstart' in window || 
        navigator.maxTouchPoints > 0 || 
        navigator.msMaxTouchPoints > 0
    );
};

const createMobileKeys = () => {
    if (!isMobileDevice()) {$('mobile-keys').style.display = 'none'; return;}
    $('mobile-keys').style.display = 'flex';
    $('mobile-keys').innerHTML = `
        <div class="mobile-keys">
            ${[0,1,2,3,4,0].map(i => 
                `<div class="mobile-key" onclick="document.onkeydown({key: '${i}'})">${i}</div>`
            ).join('')}
        </div>
    `;
};
$('hints').innerHTML=`
<div class="tables-container">
    <div class="table-wrapper">
        ${makeTable('%5 patterns','000000012340024130031420043210000000',6)}
    </div>
    <div class="table-wrapper">
        ${makeTable('Equivalent Keys','1234567890ASDFGZXCVB',5)}
    </div>
</div>
`;
newProblem();
window.addEventListener('resize', createMobileKeys);
createMobileKeys();

</script>
</body>
</html>
